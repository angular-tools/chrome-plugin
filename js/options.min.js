var Options=new function(){this.getPlugin=function(cb,$scope,defaults){chrome.runtime.getBackgroundPage(function(background){var Plugin=background.Plugin;if($scope){var apply=function(){if($scope.$root.$$phase!="$apply"&&$scope.$root.$$phase!="$digest"){$scope.$apply()}};$scope.load=function(){Plugin.get("options",function(options){$scope.options=options||defaults||{};apply()},defaults,false)};$scope.update=function(options){var promise={then:function(cb){this.cb=cb}};Plugin.set("options",options||$scope.options,function(){apply();if(typeof promise.cb=="function"){promise.cb()}});return promise};$scope.clear=function(){return $scope.update(defaults||{})};$scope.load()}return Plugin})}};