var Popup=new function(){this.getPlugin=function(cb,$scope){chrome.runtime.getBackgroundPage(function(background){var Plugin=background.Plugin;if($scope){$scope.data=Plugin.data||{};Plugin._refresh=function(){try{if($scope.$root.$$phase!="$apply"&&$scope.$root.$$phase!="$digest"){$scope.$apply()}}catch(e){}};Plugin.get("options",function(options){$scope.options=options||{};Plugin._refresh()},{},false);Plugin.get("data",function(data){Plugin.data=$scope.data=data||{};Plugin._refresh()})}cb(Plugin)})};this.getPage=function(cb){Popup.getPlugin().getPage(cb)};this.setIcon=function(obj){chrome.browserAction.setIcon(typeof obj=="string"?{path:obj}:obj)};this.setTitle=function(obj){chrome.browserAction.setTitle(typeof obj=="string"?{title:obj}:obj)};this.setText=function(obj){chrome.browserAction.setBadgeText(typeof obj=="string"?{text:obj}:obj)}};